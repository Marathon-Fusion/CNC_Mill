; Move to Machine Z position 
; Created by Cohen Weston on August 22, 2025
; Modified by Cohen Weston on August 26, 2025

M400

var zCur = move.axes[2].machinePosition
var zMin = move.axes[2].min
var zMax = move.axes[2].max

M291 P"Move to MACHINE Z position (relative to MACHINE ORIGIN)" S3 J2
if result == -1
  abort "Move cancelled"

else
  ; Z
  M291 R"Target Z" P{"Enter Z (mm). Default = current<br>Allowed values: " ^ {var.zMin} ^ " to " ^ {var.zMax}} S6 F{var.zCur} L{var.zMin} H{var.zMax} J2
  if result == -1
    abort "Move cancelled"
  var zT = input

  ; Feedrate (mm/min)
  M291 R"Feedrate" P"Enter F in mm/min" S5 F3000 L1 J2
  if result == -1
    abort "Move cancelled"
  var feed = input

  G94
  G53 G1 Z{var.zT} F{var.feed}
